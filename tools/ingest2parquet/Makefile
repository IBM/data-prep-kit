REPOROOT=../../
# Use make help, to see the available rules

include $(REPOROOT)/.make.defaults

DOCKER_IMAGE_VERSION=${INGEST_TO_PARQUET_VERSION}
DOCKER_IMAGE_NAME?=ingest2parquet
DOCKER_IMAGE=${DOCKER_REGISTRY_ENDPOINT}/$(DOCKER_IMAGE_NAME):$(DOCKER_IMAGE_VERSION)


venv::	.defaults.lib-src-venv

build::	venv image

test::	venv test-src test-image

clean:: .defaults.clean

image:: .defaults.lib-src-image

test-src:: .defaults.test-src test-local

test-image: image .defaults.test-image-pytest

minio-load:
	$(MAKE) MINIO_SRC=test-data/input MINIO_DEST=ingest2parquet/input .defaults.minio.load-test-data

minio-start: .defaults.minio.start

test-local:: .defaults.test-locals

publish:: image .defaults.publish
